#include<iostream>
#include <stdlib.h>
#include <ctime>

using namespace std;
const int TABLE_SIZE = 5000;
const int Total_operation = 5000;
const int Total_value=100000;

struct Hashnode
{ int data;
  int key;
};
struct Hashnode* HashMap[TABLE_SIZE];

static long int counter_insert; //counter for insertion
static long int counter_delete;
static long int counter_search;

int HashIndex(int key) {
   return key % TABLE_SIZE;
}
//--------------------------------------------------------------------------------------------
void Insert(int key,int value)
{  int counter=0;
   struct Hashnode* item=(struct Hashnode*)malloc(sizeof(struct Hashnode*));
   item->data=value;
   item->key=key;
  
   int h_index=HashIndex(key);
   
   while(HashMap[h_index]!=NULL && HashMap[h_index]->key!=-1)
   {
    ++h_index;
    h_index%=TABLE_SIZE;
    counter++;
    counter_insert++;
    if(counter==TABLE_SIZE)
    break;
   }
   if(counter==TABLE_SIZE)
   cout<<"No space available to insert\n";
   else
   { HashMap[h_index]=item;
     counter_insert++;
   }
}
//----------------------------------------------------------------------------------------------
struct Hashnode* Delete(int key)
{
   struct Hashnode* dummy_item=(struct Hashnode*)malloc(sizeof(struct Hashnode*));
   dummy_item->data=-1;
   dummy_item->key=-1;
   
   int h_index=HashIndex(key);
   
   while(HashMap[h_index]!=NULL)
   {
    if(HashMap[h_index]->key == key)
     {
      ++counter_delete;
      struct Hashnode* temp=HashMap[h_index];
      
      HashMap[h_index]=dummy_item;
      return temp;
     }
     ++h_index;
     ++counter_delete;

     h_index%=TABLE_SIZE;
   }
   return NULL;
}
//----------------------------------------------------------------------------------------------

struct Hashnode* Search(int key)
{
    int h_index = HashIndex(key);
    int counter=0;
    while(HashMap[h_index]!=NULL)
    {
            if(HashMap[h_index]->key==key)
             { ++counter_search;
               return HashMap[h_index];
             }
             ++h_index;
             ++counter_search;
             h_index%=TABLE_SIZE;
             ++counter;
             if(counter==TABLE_SIZE)
             break;
    }
    return NULL;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
}

//-----------------------------------------------------------------------------------------------
void display() 
{
   int i = 0;
   for(i = 0; i<TABLE_SIZE; i++) {
      if(HashMap[i] != NULL)
         cout<<"("<<HashMap[i]->key<<","<<HashMap[i]->data<<")";
      else
         cout<<" ~~ ";
   }
	
   cout<<"\n";
}
//----------------------------------------------------------------------------------------------
int main()
{     
      srand((unsigned) time(0));
      int key,value;
      int choice=1;
      int counter=1;
      while(1)
      {
          cout<<"\n----------------------"<<endl;
          cout<<"\nOperations on Hash Table"<<endl;
          cout<<"\n----------------------"<<endl;
          cout<<"1.Insert element into the table"<<endl;
          cout<<"2.Search element from the key"<<endl;
          cout<<"3.Delete element at a key"<<endl;
          cout<<"4.Exit"<<endl;
          
          ++counter;
          if(counter>TABLE_SIZE)
          { choice++;
            counter=1;
          }
          //choice = (rand() % 1) + 1; //Random choice
          cout<<"Enter your choice: "<<choice<<endl;
          //cin>>choice;
          
        switch(choice)
        {
        case 1:
            value= (rand() % Total_value) + 1; // Random Value
            cout<<"Element to be inserted: "<<value<<endl;
            //cin>>value;
            key=(rand() % Total_value) + 1;   // Random key
            cout<<"Key at which element to be inserted: "<<key<<endl;
            //cin>>key;
            Insert(key, value);
            //display();
            break;
       case 2:
            key=(rand() % Total_value) + 1;   // Random key
            cout<<"Key of the element to be searched: "<<key<<endl;
            //cin>>key;
            if(Search(key) == NULL)
            {
                cout<<"No element found at key "<<key<<endl;
                //continue;
            }
            else
            {
                cout<<"Element at key "<<key<<" : ";
                cout<<Search(key)->data<<endl;
            }
            break;
        case 3:
            key=(rand() % Total_value) + 1;   // Random key
            cout<<"Enter key of the element to be deleted: "<<key<<endl;
            //cin>>key;
            Delete(key);
            //display();
            break;
        case 4:
            display();
            cout<<"NO of block access for insertion:"<<((float)counter_insert/Total_operation)<<"\n";
            cout<<"NO of block access for searching:"<<((float)counter_search/Total_operation)<<"\n";
            cout<<"NO of block access for deletion:"<<((float)counter_delete/Total_operation)<<"\n";
            return 0;
        default:
           cout<<"\nEnter correct option\n";
       }
    }
    return 0;
}
